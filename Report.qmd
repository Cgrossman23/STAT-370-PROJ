---
title: "title"
format: pdf
author: Ashley Ciss, Coleton Grossman, William Quinn
editor: visual
indent: true
whitespace: small
---

# I. Introduction 

Along the St. Mary’s River in Michigan, there are shores being affected by the wake of ships passing through. These wakes can be between one and three meters large and eventually stir up the areas of the river and cause plant disruption. In order to understand the effect of these waves, the density of the plants, bulrush and cattail need to be found. In this specific study, there were four different collection sites, each with a control side and an exposed side.  Each data collection included certain characteristics of the data sight collection. Some of the important ones include exposure, water depth, slope, fetch, and cost distance. The main goal of the data analysis was to create a predictive model that would output the density or presence/absence of these plants in this river.

Due to the nature and situation of the sites, there was geographical and spatial correlation. Not only was each sight correlated with one another, there were transects vertical and horizontal that also contributed to the correlation. The spatial and geographical set ups of these sites play a significant role in understanding and creating a predictive model. Understanding what the river looks like as well the sites seemed to be one of the most important parts of the process. The data also did not follow a normal distribution, so there were multiple tests completed to find the best fitting distribution for the data, which was a negative binomial distribution. Using both the correlation restrictions and the client’s needs, multiple models were created and tested against each other in order to find the best one. There are different types of models that can be created to accurately represent the data, such as mixed effects, zero inflated models, and logistic regression. The best model for the data that accurately predict the outcome of presence or absence was the logistic regression. Once the best model was found, there was a Bayesian analysis completed because the spatial correlation aspect does not need to be included in the model.

# II. Methods

The consulting process was divided into two major phases: an exploratory data analysis phase and explanatory modeling phase. Most of the statistical analysis and modeling was conducted via R-Studio while some handling of geo-spatial data was conducted via GIS.

### II.a. Data Visualization

The exploratory data analysis phase primarily constituted data visualizations such as bar graphs, scatter plots, and spatial data visualization maps. Key packages utilized in this phase were ggplot2, ggmap, and the sf package.

### II.b. Explanatory Modeling

The modeling phase of this project consisted of four distinct sub-phases: creating geographical correlation matrices, creating and testing zero-inflated models (ZIM’s), creating and testing mixed effect models (with and without ZIM elements), and the creation of two global models (a ZIM and a logistic regression model) with spatial lag explanatory variables. All models are explanatory models and seek to isolate and identify the influence of the variable *exposure* while controlling for the influence of potentially other significant variables such as *water_depth* and *speed_limit*.

#### II.b.1. **Geographical Correlation Matrices**

This code section was conducted with the purpose of fully capturing the maximum number of geographical correlations as defined under the Moran’s I equation. The Moran’s I equation resembles the standard variance equation; except that it seeks to account for the strength (or weakness) of geographical correlation via a weighted matrix. The formula for Moran’s I is as follows:

$$
I = \frac{N \sum_{i=1}^{n}\sum_{j=1}^{n}W_{ij}(X_i - \bar{X})(X_j - \bar{X})}{(\sum_{i=1}^{n}\sum_{j=1}^{n}W_{ij}) \sum_{i=1}^{n}(X_i - \bar{X})^2}
$$

Moran’s I is a measurement that ranges from \[-1,1\]. A value of 1 represents perfect positive autocorrelation. This would be a geographical data set in which values are perfectly geographically close (or attracted) to other similarly valued observations. A value of -1 represents perfect negative autocorrelation and means that data values are perfectly geographical distant (or repulsed) by other similarly valued observations. Moran’s I values that are near 0 indicate a lack of geographical correlation.

It was found necessary to calculate this measure due to the perceived violation of geographical independence by our data set. Our preliminary data visualizations displayed that plots with plant presence tended to clump together in chunks, indicating the presence of positive autocorrelation. By calculating the Moran’s I measurement we were able to verify the validity or invalidity of non-geographic models so as to confirm the presence of geographical correlations. Furthermore, the spatial weights matrix produced was used to create the spatial lag elements in our final global model.

A separate spatial weights matrix was constructed for each of our 4 non-exposed plots due to the differing plant densities observed across them. No spatial weights matrix was constructed for the 4 exposed plots due to the lack of any plant present plots in these segments.  These spatial weights matrices account for are weighted in the sense that instead of accounting for presence/absence of roots, they account for the root density when identifying the strength between two neighboring observations. The pseudo-code for the creation of each of these 4 individual weights matrices and Moran’s I measurements is below. Via this function we produced Moran’s I measurements that ranged from roughly \[0.292, 0.81\]. This indicates a moderate to strong geographical influence on plant root density.

Pseudo-code:

// Step 1: Extract spatial coordinates

Set coordinates_matrix to the combination of latitude and longitude columns from the dataset

// Step 2: Define a sequence of distance thresholds to test

Set distance_values to a sequence from the minimum to maximum distance (e.g., 0.000001 to 0.001 with small increments)

// Step 3: Initialize a container for Moran’s I values at each distance

Create moran_I_values as a list of NA values, same length as distance_values

// Step 4: Initialize variables to track the maximum Moran’s I and its associated distance

Set max_moran_I to negative infinity

Set optimal_distance to NA

Set optimal_neighbors to NULL

Set optimal_weights to NULL

// Step 5: For each candidate distance threshold, do:

For each distance in distance_values:

    - Identify neighbor relationships among coordinates using a fixed maximum distance

      neighbors ← all pairs of points within this distance

    - If no neighbors are found, skip to the next distance

    - Compute the distances between all neighbors

    - Construct spatial weights: inverse of distance, row-standardized

    - Calculate Moran’s I statistic for the outcome variable (e.g., population density) using the weights

    - Store the Moran’s I value

    - If this Moran’s I is the highest so far:

        • Update max_moran_I

        • Save the current distance as optimal_distance

        • Save the neighbor structure and weights

End pseudo code.

#### II.b.2. ZIM

The first explanatory models were constructed with just a zero-inflated element. These models were created in order to test for the significance of geographical correlations within each plot against a properly fitted model. So as to account for clustering effects 4 separate models were constructed: one for each unexposed plot per site. Once a properly fitted model was constructed for each plot, the residuals of the model were tested against the spatial weighted matrix of the plot. This was conducted via the moran.test command found in the *spdep* package.

The assumed underlying distribution for the zero-inflated model was a Poisson distribution. The formula for this model is as follows:

# III. Results

# IV. Conclusion
